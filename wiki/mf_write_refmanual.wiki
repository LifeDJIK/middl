#summary Reference for writing midi files
= Writing Midi files =

To create a midifile, first a `mf_writer` must be created with:

{{{
mf_writer *mf_new (char *fname,short format, short ntracks, short division);

}}}


{{{
int createmidifile(char *fname)
{
   mf_writer *m;
   int ret = 999;
   
   if ((m = mf_new(fname,1,2,192))) {  ret = 0; }
   
   if (!ret)  {ret = mf_track_start(m);}
   if (!ret)  {ret = mf_midi_evt(m,  0,st_note_on ,0,64,100);}
   if (!ret)  {ret = mf_midi_evt(m,192,st_note_off,0,64,0);}

   if (!ret)  {ret = mf_midi_evt(m,  0,st_note_on ,0,67,100);}
   if (!ret)  {ret = mf_midi_evt(m,192,st_note_off,0,67,0);}
   if (!ret)  {ret = mf_track_end(m);}
   
   if (!ret)  {ret = mf_track_start(m);}
   if (!ret)  {ret = mf_midi_evt(m,  0,st_note_on ,0,60,100);}
   if (!ret)  {ret = mf_midi_evt(m,384,st_note_off,0,60,0);}
   if (!ret)  {ret = mf_track_end(m);}

   if (!ret)  {ret = mf_close(m);}
   
   if (ret)   { fprintf(stderr, "ERROR: %d\n",ret); }
   return ret;
}
}}}